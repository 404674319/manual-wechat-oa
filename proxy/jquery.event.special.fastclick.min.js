/*
 * jQuery Mobile Plugin: jQuery.Event.Special.Fastclick
 * http://nischenspringer.de/jquery/fastclick
 *
 * Copyright 2013 Tobias Plaputta
 * Released under the MIT license.
 * http://nischenspringer.de/license
 *
 */(function(b){var d=b([]),g=[],c={},h=function(a){var b,c;b=0;for(c=g.length;b<c;b++)30>Math.abs(a.pageX-g[b].x)&&30>Math.abs(a.pageY-g[b].y)&&(a.stopImmediatePropagation(),a.stopPropagation(),a.preventDefault())},f=!0;Modernizr&&Modernizr.hasOwnProperty("touch")&&(f=Modernizr.touch);var k=function(){g.splice(0,1)};b.event.special.fastclick={touchstart:function(a){c.startX=a.originalEvent.touches[0].pageX;c.startY=a.originalEvent.touches[0].pageY;c.hasMoved=!1;b(this).on("touchmove",b.event.special.fastclick.touchmove)},touchmove:function(a){if(10<Math.abs(a.originalEvent.touches[0].pageX-c.startX)||10<Math.abs(a.originalEvent.touches[0].pageX-c.startY))c.hasMoved=!0,b(this).off("touchmove",b.event.special.fastclick.touchmove)},add:function(a){if(f){var e=b(this);e.data("objHandlers")[a.guid]=a;var d=a.handler;a.handler=function(a){e.off("touchmove",b.event.special.fastclick.touchmove);if(!c.hasMoved){g.push({x:c.startX,y:c.startY});window.setTimeout(k,800);b([]);var f=arguments;b.each(e.data("objHandlers"),function(){this.selector?b(this.selector,e).each(function(){(this==a.target||0<b(this).has(a.target).length)&&d.apply(this,f)}):(e[0]==a.target||0<e.has(a.target).length)&&d.apply(e,f)})}}}},setup:function(a,e,g){a=b(this);if(f)d=d.add(a),a.data("objHandlers")||(a.data("objHandlers",{}),a.on("touchstart",b.event.special.fastclick.touchstart),a.on("touchend touchcancel",b.event.special.fastclick.handler)),c.ghostbuster||(b(document).on("click vclick",h),c.ghostbuster=!0);else a.on("click",b.event.special.fastclick.handler)},teardown:function(a){a=b(this);f?(d=d.not(a),a.off("touchstart",b.event.special.fastclick.touchstart),a.off("touchmove",b.event.special.fastclick.touchmove),a.off("touchend touchcancel",b.event.special.fastclick.handler),0==d.length&&(b(document).off("click vclick",h),c.ghostbuster=!1)):a.off("click",b.event.special.fastclick.handler)},remove:function(a){f&&delete b(this).data("objHandlers")[a.guid]},handler:function(a){var c=a.type;a.type="fastclick";b.event.trigger.call(this,a,{},this,!0);a.type=c}}})(jQuery);